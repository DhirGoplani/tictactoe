<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Tic Tac Toe â€” PvP</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Tic Tac Toe</h1>

  <div id="playerInfo">
    <div class="player-box">
      <div id="char1" class="char-box">X</div>
      <span>Player 1</span>
    </div>
    <div class="player-box">
      <div id="char2" class="char-box">O</div>
      <span>Player 2</span>
    </div>
  </div>

  <div id="board"></div>
  <div id="status"></div>
  <div id="score">Player 1: 0 | Player 2: 0</div>

  <div id="buttons">
    <button id="toggleTheme">Toggle Dark/Light</button>
    <button id="reset">Reset</button>
    <button id="back">Back to Menu</button>
  </div>

<script>
  const toggleThemeBtn = document.getElementById('toggleTheme');
  function applyThemeFromStorage(){ if(localStorage.getItem('ttt-theme')==='dark') document.body.classList.add('dark'); toggleThemeBtn.textContent = document.body.classList.contains('dark') ? 'Switch to Light' : 'Switch to Dark'; }
  applyThemeFromStorage();
  toggleThemeBtn.addEventListener('click', ()=>{
    document.body.classList.toggle('dark');
    const isDark = document.body.classList.contains('dark');
    localStorage.setItem('ttt-theme', isDark ? 'dark' : 'light');
    toggleThemeBtn.textContent = isDark ? 'Switch to Light' : 'Switch to Dark';
  });
  const board = document.getElementById("board");
  const status = document.getElementById("status");
  const resetBtn = document.getElementById("reset");
  const backBtn = document.getElementById("back");
  const char1 = document.getElementById("char1");
  const char2 = document.getElementById("char2");
  const scoreBoard = document.getElementById("score");
  let resetCount = 0;
  let currentTurn;
  let gameOver = false;
  let cells = Array(9).fill("");
  let player1Score = 0;
  let player2Score = 0;
  function getChars(){
    return resetCount % 2 === 0 ? ["X", "O"] : ["O", "X"];
  }
  function updateCharDisplay(){
    const [p1, p2] = getChars();
    char1.textContent = p1;
    char2.textContent = p2;
  }
  function createBoard(){
    board.innerHTML = "";
    for (let i = 0; i < 9; i++){
      const cell = document.createElement("div");
      cell.classList.add("box");
      cell.dataset.index = i;
      cell.textContent = cells[i];
      cell.addEventListener("click", handleClick);
      board.appendChild(cell);
    }
  }
  function handleClick(e){
    const idx = Number(e.target.dataset.index);
    if(cells[idx] !== "" || gameOver) return;
    cells[idx] = currentTurn;
    e.target.textContent = currentTurn;
    checkWinner();
    if(!gameOver){
      currentTurn = currentTurn === "X" ? "O" : "X";
    }
  }
  function checkWinner(){
    const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
    const [p1Char, p2Char] = getChars();
    for(const [a,b,c] of wins){
      if(cells[a] && cells[a] === cells[b] && cells[b] === cells[c]){
        status.textContent = cells[a] + " wins!";
        gameOver = true;
        if(cells[a] === p1Char) player1Score++; else player2Score++;
        updateScore();
        const boxes = document.querySelectorAll(".box");
        boxes[a].classList.add("winning");
        boxes[b].classList.add("winning");
        boxes[c].classList.add("winning");
        return;
      }
    }
    if(!cells.includes("")){
      status.textContent = "It's a draw!";
      gameOver = true;
    }
  }
  function updateScore(){
    scoreBoard.textContent = "Player 1: "+ player1Score +" | Player 2: "+ player2Score;
  }
  function resetGame(){
    resetCount++;
    cells = Array(9).fill("");
    gameOver = false;
    status.textContent = "";
    updateCharDisplay();
    const [p1Char, p2Char] = getChars();
    currentTurn = p1Char;
    createBoard();
    document.querySelectorAll(".box").forEach(box => box.classList.remove("winning"));
  }

  resetBtn.addEventListener("click", resetGame);
  backBtn.addEventListener("click", ()=> location.href = 'index.html');

  updateCharDisplay();
  const [p1Char, p2Char] = getChars();
  currentTurn = p1Char;
  createBoard();
</script>
</body>
</html>
